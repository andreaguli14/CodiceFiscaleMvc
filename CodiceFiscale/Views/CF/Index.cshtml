@using DataLayer
@model PersonaDataViewModel



<form method="post">
	<div class="d-flex justify-content-center">
		<div class=" d-flex flex-column bottone">

			<div class="carta">
				<div class="fisc">

					@if (Model.CodiceFiscale != "")
					{
						<strong>@Model.CodiceFiscale</strong>
					}
					else
					{
						<strong>&nbsp;</strong>
					}

				</div>

				<input asp-for="@Model.LastName" class="text-form surname">

				<br />

				<input asp-for="@Model.FirstName" class="text-form name">

				<br />

				<select id="comuni" asp-for="@Model.Istat" class="text-form istat">
				</select>


				<select asp-for="@Model.Gender" class="text-form gender">
					<option default>M</option>
					<option>F</option>
				</select>

				<br />

				<select id="province" class="text-form province">
				</select>


				<input asp-for="@Model.Birthday" class="text-form data" type="date">

			</div>
			<br />
			<button class="btn btn-lg btn-success text-center bottone">Calcola</button>
		</div>
	</div>
</form>









<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>
	$(document).ready(function () {
		id = "";
		loadProvince()
		loadComuni(id)
	});


	$("#province").change(function () {
		id = "";
		id = $(this).val().slice(0, 2);
		loadComuni(id);
	});


	$("#comuni").change(function () {
		id = "#" + $(this).val().slice(0, 2);
		$(id).attr("selected", true);
	});


	function loadProvince(id) {
		$("#province").empty();
		$.ajax({
			url: '/cf/GetProvince/',
			success: function (response) {
				$("#province").append("<option  disabled value=''>PR</option>");
				$.each(response, function (i, data) {
					$("#province").append("<option id='" + data.sigla + "'value='" + data.sigla + "' >" + data.sigla + "</option>");
				});





			}
		})
	}

	function loadComuni(id) {
		$("#comuni").empty();

		$.ajax({
			url: '/cf/GetComuni/' + id,
			success: function (response) {
				$("#comuni").append("<option default disabled value=''>Comune</option>");
				$.each(response, function (i, data) {
					$("#comuni").append("<option value='" + data.sigla + data.comune + "' >" + data.comune + "</option>");
				})

			}
		})
	}</script>

